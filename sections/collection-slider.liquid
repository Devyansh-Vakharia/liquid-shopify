<div class="flickity-section-{{ section.id }} flickity-index-slider collection" style="background-color: {{ section.settings.bg }}">
  <div class="page-width">
    <div>
      <p class="text-title text-center" style="margin-bottom:{{ section.settings.title_mb }}px">{{ section.settings.title }}</p>
    </div>
    <div class="flickity-section__carousel carousel-{{section.id }} text-center"
         data-flickity='{
           "cellAlign": "{{ cell_align }}",
           "pageDots": true,
           "prevNextButtons": true, // Add this line to enable previous and next buttons
           "freeScroll": true,
           "contain": true,
           "wrapAround": {{ wrap_around }}
         }'>

      {% for product in collection_main.products limit: collection_limit %}
        {%- if product.metafields.inventory.ShappifyHidden == 'true' -%}{%- continue -%}{%- endif -%}
        {% assign first_variant = product.selected_or_first_available_variant %}
        {% assign featured_img_src = first_variant.featured_img.src | default: product.featured_image.src %}
        {% assign price = first_variant.price %}
        {% assign compare_at_price = first_variant.compare_at_price %}
        <div class="carousel__cell">
          <a href="{{ product.url }}">
            <img src="{{ featured_img_src | img_url: img_width }}" alt="{{ product.featured_img.alt }}" />
          </a>
          <a href="{{ product.url }}">
            <h5>{{ product.title }}</h5>
          </a>
          {% if compare_at_price > price %}
            <s class="product__compare-at-price">{{ compare_at_price | money }}</s>
            <p class="product__product-price">{{ price | money }}</p>
          {% else %}
            <p class="product__product-price">{{ price | money }}</p>
          {% endif %}
        </div>
      {% endfor %}

    </div>
  </div>
</div>

<style>
  /* Add this CSS for customizing previous and next buttons */
  .flickity-prev-next-button {
    width: 40px; /* Customize width as needed */
    height: 40px; /* Customize height as needed */
    background: #333; /* Customize button color */
    border-radius: 50%; /* Make it round */
  }

  .flickity-prev-next-button:hover {
    background: #555; /* Customize hover color */
  }

  /* Add this CSS to customize the dot navigation */
  .flickity-page-dots {
    bottom: 10px; /* Adjust the distance from the bottom */
  }

  /* Optional: Customize dot appearance */
  .flickity-page-dots .dot {
    width: 12px; /* Customize dot size */
    height: 12px; /* Customize dot size */
    margin: 0 8px; /* Adjust space between dots */
    background: #ccc; /* Customize dot color */
    border-radius: 50%; /* Make dots round */
  }

  .flickity-page-dots .dot.is-selected {
    background: #333; /* Customize selected dot color */
  }
</style>
{% schema %}
{
  "name": "Collection Slider",
  "settings": [
    {
      "type": "collection",
      "id": "collection_main",
      "label": "Choose a Collection"
    },
    {
      "type": "range",
      "id": "collection_limit",
      "min": 2,
      "max": 50,
      "step": 1,
      "unit": ".",
      "label": "How many products to show",
      "default": 4
    },
    {
      "type": "color",
      "id": "bg",
      "label": "Background Color"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "Featured Collection Slider"
    },
    {
      "type": "range",
      "id": "img_width",
      "min": 200,
      "max": 600,
      "step": 5,
      "unit": "px",
      "label": "Image Width",
      "default": 200
    },
    {
      "type": "select",
      "id": "cell_align",
      "label": "Slide Alignment",
      "options": [
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "left",
          "label": "Left"
        }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "title_mb",
      "min": 30,
      "max": 120,
      "step": 1,
      "unit": "px",
      "label": "Title Margin Bottom",
      "default": 48
    },
    {
      "type": "radio",
      "id": "wrap_around",
      "label": "Enable Wrap Around (endless scrolling)",
      "options": [
        {
          "value": "true",
          "label": "True"
        },
        {
          "value": "false",
          "label": "False"
        }
      ],
      "default": "true"
    }
  ],
  "presets": [
    {
      "name": "Collection Slider",
      "category": "Slider"
    }
  ]
}
{% endschema %}